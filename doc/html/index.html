<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFTGEN: fftGen</title>



<link href="doxy.css" rel="stylesheet" type="text/css" />
<style type='text/css'><!--code{font-weight:bold}--></style></head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FFTGEN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">fftGen </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Name"></a>
NAME</h1>
<p >fftGen - Generate code to compute an FFT or IFFT</p>
<h1><a class="anchor" id="Synopsis"></a>
SYNOPSIS</h1>
<p ><b>fftGen</b> [option]...</p>
<dl class="section user"><dt>Options:</dt><dd>[<code>-n</code> <em>number</em>] [<code>--points</code> <em>number</em>] [<code>-i</code>] [<code>--inverse</code>] [<code>-r</code>] [<code>--real-in-opt</code>] [<code>-o</code>] [<code>--real-out-opt</code>] [<code>-m</code>] [<code>--symm-in-opt</code>] [<code>-s</code>] [<code>--symm-out-opt</code>] [<code>-l</code>] [<code>--license</code>] [<code>-v</code>] [<code>--verbose</code>] [<code>-V</code>] [<code>--version</code>] [<code>-h</code>] [<code>--help</code>]</dd></dl>
<p>Note that it is <em>required</em> to specify the number of data points with options <code>-n</code> or <code>--points</code>.</p>
<h1><a class="anchor" id="Description"></a>
DESCRIPTION</h1>
<p >The program generates code to compute a Fast Fourier Transform (FFT) or Inverse Fast Fourier Transform (IFFT) for the C or C++ programming language. Target of the generated code is to compute the algorithms in a very fast way.</p>
<p >The program needs to know the number of data points for the FFT. Either option <code>-n</code> or <code>--points</code> must therefore always be specified when the program is called. The value of these options specifies the number of data points. It must always be a power of two and it must not be zero. It may be equal one, however, value one doesn't make much sense because in that case no code is produced.</p>
<p >If the program shall compute an inverse FFT then option <code>-i</code> or <code>--inverse</code> must be given as argument. Note that in this case the result is scaled by <code>n</code> if <code>n</code> is the number of data points. To get the correct result of an inverse FFT the results of the generated code must be divided by <code>n</code>.</p>
<p >The transform is conducted "in place", that means the resulting output sequence overwrites the input sequence.</p>
<h2><a class="anchor" id="Optimizations"></a>
Optimizations</h2>
<p >The speed of computation is achieved by a number of optimizations of the standard Cooley-Tukey algorithm:</p>
<ol type="1">
<li><p class="startli">Precomputing sine and cosine function values</p>
<p class="startli">During an FFT a lot of sine and cosine function values are to be computed. Computation of these function values is time-consuming. However, they are fixed and known for any FFT of a certain number of data points. It is thus possible to compute those function values once before conducting the actual transform - at best already at compile time.</p>
</li>
<li><p class="startli">Unrolling loops</p>
<p class="startli">The FFT is usually computed in several loops. However, executing the loop control statements needs some time. That time can be saved if the loops are unrolled, that means, instead of jumping from the end of a loop to its beginning the statements of the loop are copied in series.</p>
<p class="startli">Drawback is certainly that the size of program increases.</p>
</li>
<li><p class="startli">Inserting precomputed sine and cosine function values immediately into the algorithm</p>
<p class="startli">Both abovementioned optimizations offer this possibility. The precomputed function values can be inserted as literal constants directly into the source code of the unrolled loops. The access to those immediate constants is much faster than the indirect access to an array which would contain the precomputed values otherwise.</p>
<p class="startli">However, this comes also at the downside of increased code size.</p>
</li>
<li>Removing multiplications by one</li>
<li>Removing summands in expressions which are the result of a multiplication by zero</li>
<li><p class="startli">Removing all operations assumed to be obsolete because the input sequence consists of real values only</p>
<p class="startli">This optimization is optional because it will produce wrong results if the input sequence contains non-zero imaginary values.</p>
<p class="startli">To activate this optimization use option <code>-r</code>.</p>
<p class="startli">If this option is specified then it is not necessary to initialize the array for imaginary values because these values are ignored.</p>
</li>
<li><p class="startli">Removing all operations required to calculate points in the second half of the FFT result sequence</p>
<p class="startli">If the input sequence consists of real values only then the values of the resulting sequence are symmetrical to the value with index n/2 (indices starting at 0) if n is the number of data points - according to the following expression: </p><div class="fragment"><div class="line">x[i] = x*[n-i]     <span class="keywordflow">for</span> i=n/2+1...n-1</div>
</div><!-- fragment --><p> x*[n-i] denoting the conjugate complex value to x[n-i]. The conjugate complex value of complex variable z has the same real value and the negative imaginary value of z.</p>
<p class="startli">It is thus not necessary to calculate the points from n/2+1 on. They are usually not required and if needed they can anyway be calculated later in the way described above.</p>
<p class="startli">This optimization is optional because it will produce wrong results if the input sequence contains non-zero imaginary values.</p>
<p class="startli">To activate this optimization use option <code>-s</code>.</p>
<p class="startli">Note that if this option is specified then the points from n/2+1 onwards contain useless arbitrary values.</p>
</li>
<li><p class="startli">Removing all operations assumed to be obsolete because the output sequence consists of real values only</p>
<p class="startli">This optimization is optional because it will produce wrong results if the input sequence will produce non-zero imaginary values in the result sequence.</p>
<p class="startli">To activate this optimization use option <code>-o</code>.</p>
<p class="startli">The output sequence contains real only values in case of an IFFT with an input sequence being the result of an FFT with real only input.</p>
<p class="startli">Note that a lot of manipulations of the result of the FFT that was used to generate the IFFT input sequence will spoil the property of generating real only output values in that IFFT. So use that option with care. It might be a good idea to first check the IFFT result before using this option.</p>
<p class="startli">Note that if this option is specified then the imaginary values in the result sequence contain useless arbitrary values.</p>
</li>
<li><p class="startli">Removing all operations being obsolete because the input sequence is assumed to be symmetrical around the value with index n/2+1 (indices starting at 0) if n is the number of data points</p>
<p class="startli">For the exact assumed symmetry relationship see abovementioned optimization 7. A sequence gets that kind of symmetry if it is the result of an FFT (or IFFT) with real only input data points.</p>
<p class="startli">To activate this optimization use option <code>-m</code>.</p>
<p class="startli">If this option is specified then it is not necessary to initialize the arrays for real and imaginary values from the value with index n/2+1 onwards (indices starting at 0) because these values are ignored.</p>
</li>
</ol>
<h2><a class="anchor" id="Combinations"></a>
Combinations of Optimizations</h2>
<p >Optimizations 6. and 7. (options <code>-r</code> and <code>-s</code>) are both for real only input sequences for normal FFT and are therefore usually specified together.</p>
<p >Optimizations 8. and 9. (options <code>-o</code> and <code>-m</code>) are both for symmetrical input sequences for FFTs and IFFTs and are therefore usually specified together.</p>
<p >Optimization 8. (option <code>-o</code>) is usually for inverse FFTs only. It thus does not make much sense to combine it with options <code>-r</code> or <code>-s</code>.</p>
<h1><a class="anchor" id="Size"></a>
Size of the Generated Code</h1>
<p >Unrolling the loops increases the code size drastically. If <code>m</code> is the power of two exponent to compute the number of data points of the FFT then the generated lines of code for the FFT internal binary inversion algorithm can be computed by </p><div class="fragment"><div class="line">LOC_B = 2**(m/2) - 2**((m-1)/2) * 6</div>
</div><!-- fragment --><p> ** means exponentiation</p>
<p >The generated lines of code for the rest of the FFT transform can be calculated by </p><div class="fragment"><div class="line">LOC_T = m*2**(m-1) * 6</div>
</div><!-- fragment --><p> The total number of code lines for a certain number <code>n</code> of FFT data points is </p><div class="fragment"><div class="line">m   n       LOC_B   LOC_T   Total</div>
<div class="line">3   8       12      72      84</div>
<div class="line">4   16      36      192     228</div>
<div class="line">5   32      72      480     552</div>
<div class="line">6   64      168     1152    1320</div>
<div class="line">7   128     336     2688    3024</div>
<div class="line">8   256     720     6144    6844</div>
<div class="line">9   512     1440    13824   15264</div>
<div class="line">10  1024    2976    30720   33696</div>
</div><!-- fragment --><p> Optimizations 6. to 9. will reduce the number of code lines a bit. For <code>m</code>=5 (i.e. <code>n</code>=32) with optimizations 6. and 7. (options <code>-r</code> and <code>-s</code>) the total number of code lines reduces to 365.</p>
<h1><a class="anchor" id="Integration"></a>
INTEGRATION</h1>
<p >The program generates the FFT code only, no function header and no function ending. The generated code requires some defined variables:</p><ul>
<li>Two defined arrays for the complex sequence points, in particular<ul>
<li>array <code>xr[]</code> for the real values and</li>
<li>array <code>xi[]</code>.</li>
</ul>
Both arrays must be of size <code>n</code>, where <code>n</code> is the number of data points of the FFT or IFFT.</li>
<li>Two variables to store intermediate values:<ul>
<li><code>tr</code> and</li>
<li><code>ti</code>.</li>
</ul>
</li>
</ul>
<p >Advantage of this approach is that no assumption is required for the generated code regarding the concrete type of the involved variables. The arrays and variables can therefore be of any valid floating point type, e.g. <code>double</code> or <code>float</code>.</p>
<p >The generated code can easiest be integrated if it is piped to a file which is then included via an <code>#include</code> preprocessor statement into a function body that provides the required definitions.</p>
<p ><b>Example:</b> </p>
<p >Assumed the generated code has been written to file <code>fft.c</code> and the FFT should be computed in <code>float</code> arithmetic. Then the according code could look like </p><div class="fragment"><div class="line"><span class="keywordtype">void</span>  fft (<span class="keywordtype">float</span> *xr, <span class="keywordtype">float</span> *xi) {</div>
<div class="line">    <span class="keywordtype">float</span>  tr, ti;</div>
<div class="line"><span class="preprocessor">#include &quot;fft.c&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><p >Function <code>fft()</code> can now be called to compute the FFT. The calling program must</p><ul>
<li>define the two arrays and</li>
<li>fill them with the input values for the FFT,</li>
<li>then call function <code>fft()</code> with the pointers to those arrays as arguments,</li>
<li>take the resulting transformed values from the arrays.</li>
<li>In case of an inverse FFT the results must be divided by <code>n</code> the number of the data points.</li>
</ul>
<h1><a class="anchor" id="Options"></a>
OPTIONS</h1>
<dl class="section user"><dt><code>-n</code>, <code>--points</code> <em>number</em> </dt><dd>Number of data points of the FFT. The number must be a power of two.<br  />
This option is not optional. It must be given to specify the required number of data points.</dd></dl>
<dl class="section user"><dt><code>-i</code>, <code>--inverse</code> </dt><dd>Generate code to calculate an inverse FFT.</dd></dl>
<dl class="section user"><dt><code>-r</code>, <code>--real-in-opt</code> </dt><dd>Optimize the code assuming that the imaginary input values are all zero, see <a class="el" href="index.html#Optimizations">Optimizations</a>.</dd></dl>
<dl class="section user"><dt><code>-o</code>, <code>--real-out-opt</code> </dt><dd>Optimize the code assuming that in the result sequence all imaginary values are zero. This is the case for an IFFT with an input sequence being the result of an FFT with real only input. Use with care, see <a class="el" href="index.html#Optimizations">Optimizations</a>.</dd></dl>
<dl class="section user"><dt><code>-s</code>, <code>--symm-out-opt</code> </dt><dd>Optimize the code assuming that the FFT result is symmetrical to element n/2 if n is the number of data points passed with option <code>-n</code> (indices starting at 0). The result of the FFT is symmetrical around n/2 if the imaginary input values are all zero. For details see <a class="el" href="index.html#Optimizations">Optimizations</a>.</dd></dl>
<dl class="section user"><dt><code>-m</code>, <code>--symm-in-opt</code> </dt><dd>Optimize the code assuming that the FFT input sequence is symmetrical to element n/2 if n is the number of data points passed with option <code>-n</code> (indices starting at 0), see <a class="el" href="index.html#Optimizations">Optimizations</a>.</dd></dl>
<dl class="section user"><dt><code>-l</code>, <code>--license</code> </dt><dd>Write a short GPL 3 license note at the beginning of the generated code.</dd></dl>
<dl class="section user"><dt><code>-v</code>, <code>--verbose</code> </dt><dd>Increase verbosity level, can be specified more than once. On level one writes the chosen options to <code>stderr</code>.</dd></dl>
<dl class="section user"><dt><code>-V</code>, <code>--version</code> </dt><dd>Print version information and exit.</dd></dl>
<dl class="section user"><dt><code>-h</code>, <code>--help</code> </dt><dd>Print this info.</dd></dl>
<h1><a class="anchor" id="ExitStatus"></a>
EXIT STATUS</h1>
<p >If no errors occurred in the course of the program the program terminates with exit code <code>0</code>. Otherwise it returns a system dependent error code different from zero, see <code>man</code> <code>stdlib.h</code> -&gt; <code>EXIT_FAILURE</code>.</p>
<h1><a class="anchor" id="Diagnostics"></a>
DIAGNOSTICS</h1>
<p >Error messages are routed to <code>stderr</code>. They are sometimes accompanied by a more detailed error description.</p>
<dl class="section user"><dt>"Unknown argument"</dt><dd></dd></dl>
<dl class="section user"><dt>"Unknown option"</dt><dd></dd></dl>
<dl class="section user"><dt>"Invalid option argument"</dt><dd>Wrong command line argument or option. See <a class="el" href="index.html#Synopsis">SYNOPSIS</a> or <a class="el" href="index.html#Options">OPTIONS</a>.</dd></dl>
<dl class="section user"><dt>"Error allocating memory"</dt><dd>Not enough heap memory available. It might help to close some applications.</dd></dl>
<dl class="section user"><dt>"No number of points specified"</dt><dd>The number of points must be specified using option <code>-n</code>. It must be a power of two. See <a class="el" href="index.html#Synopsis">SYNOPSIS</a> or <a class="el" href="index.html#Options">OPTIONS</a>.</dd></dl>
<dl class="section user"><dt>"Number of points is not a power of two"</dt><dd>The number of data points specified with option <code>-n</code> must be a power of two. See <a class="el" href="index.html#Description">DESCRIPTION</a> or <a class="el" href="index.html#Options">OPTIONS</a>.</dd></dl>
<h1><a class="anchor" id="KnownBugs"></a>
KNOWN BUGS</h1>
<p >Not yet known. If you find one send an according note to the author.</p>
<h1><a class="anchor" id="Author"></a>
AUTHOR</h1>
<p ><a href="#" onclick="location.href='mai'+'lto:'+'jos'+'t.'+'bra'+'ch'+'ert'+'@g'+'mx.'+'de'; return false;">jost.<span class="obfuscator">.nosp@m.</span>brac<span class="obfuscator">.nosp@m.</span>hert@<span class="obfuscator">.nosp@m.</span>gmx.<span class="obfuscator">.nosp@m.</span>de</a></p>
<h1><a class="anchor" id="Copyright"></a>
COPYRIGHT</h1>
<p >Copyright (C) 2021 Jost Brachert, <a href="#" onclick="location.href='mai'+'lto:'+'jos'+'t.'+'bra'+'ch'+'ert'+'@g'+'mx.'+'de'; return false;">jost.<span class="obfuscator">.nosp@m.</span>brac<span class="obfuscator">.nosp@m.</span>hert@<span class="obfuscator">.nosp@m.</span>gmx.<span class="obfuscator">.nosp@m.</span>de</a></p>
<p >This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the license, or (at your option) any later version.</p>
<p >This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p >You should have received a copy of the GNU General Public License along with this program, see file COPYING. If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
 